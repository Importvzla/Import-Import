<?xml version="1.0" encoding="UTF-8" ?>

<odoo>
    <data>

        <template id="default_total_tagline_inc">
            <div id="total_tagline">

                <t t-if="o.company_id.currency_id.name == 'USD'">
                    <t t-set="subtotal" t-value="o.amount_untaxed"/>
                    <t t-set="impuesto" t-value="o.amount_tax"/>
                    <t t-set="total" t-value="o.amount_total"/>
                </t>
                <t t-else="">
                    <t t-set="subtotal" t-value="o.amount_untaxed / o.x_tasa"/>
                    <t t-set="impuesto" t-value="o.amount_tax / o.x_tasa"/>
                    <t t-set="total" t-value="o.amount_total / o.x_tasa"/>
                </t>
                <div id="total" class="row border-top border-dark">
                    <div class="col-2">
                    </div>
                    <div class="col-10">
                        <t t-if="o.amount_tax != 0.0">
                            <div class="row">
                                <div class="col text-right" style="width: 82%;">
                                    <strong>Subtotal</strong>
                                </div>
                                <div class="col text-right" style="width: 18%;">
                                    <span t-esc="subtotal" t-options='{"widget": "monetary", "display_currency": currency_obj}'/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col text-right" style="width: 82%;">
                                    <span>Impuesto al Valor Agregado (IVA) 16% sobre BASE IMPONIBLE </span>
                                    <span t-esc="subtotal" t-options='{"widget": "monetary", "display_currency": currency_obj}'/>
                                </div>
                                <div class="col text-right" style="width: 18%;">
                                    <span t-esc="impuesto" t-options='{"widget": "monetary", "display_currency": currency_obj}'/>
                                </div>
                            </div>
                        </t>
                        <div class="row">
                            <div class="col text-right" style="width: 82%;">
                                <strong>Total</strong>
                            </div>
                            <div class="col text-right" style="width: 18%;">
                                <span t-esc="total" t-options='{"widget": "monetary", "display_currency": currency_obj}'/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id="lower_inc_section_usd">

            <t t-if="o.currency_id.name == 'USD'">
                <t t-set="base_imponible" t-value="tax_base"/>
                <t t-set="exento" t-value="exempt_sum"/>
                <t t-set="subtotal" t-value="tax_base + exempt_sum"/>
                <t t-set="impuesto" t-value="tax_iva"/>
                <t t-set="total" t-value="amount_total"/>

                <t t-set="base_imponible_rate" t-value="base_imponible * o.x_tasa"/>
                <t t-set="subtotal_rate" t-value="subtotal * o.x_tasa"/>

                <t t-if="impuesto > 0.0">
                    <t t-set="impuesto_rate" t-value="subtotal_rate * 0.16"/>
                </t>
                <t t-else="">
                    <t t-set="impuesto_rate" t-value="0.0"/>
                </t>
                <t t-set="total_rate" t-value="subtotal_rate + impuesto_rate"/>

            </t>
            <t t-else="">
                <t t-set="base_imponible" t-value="tax_base / o.x_tasa"/>
                <t t-set="exento" t-value="exempt_sum / o.x_tasa"/>
                <t t-set="subtotal" t-value="(tax_base + exempt_sum) / o.x_tasa"/>
                <t t-set="impuesto" t-value="tax_iva / o.x_tasa"/>
                <t t-set="total" t-value="amount_total / o.x_tasa"/>

                <t t-set="base_imponible_rate" t-value="base_imponible"/>
                <t t-set="subtotal_rate" t-value="(tax_base + exempt_sum)"/>

                <t t-if="tax_iva > 0.0">
                    <t t-set="impuesto_rate" t-value="subtotal_rate * 0.16"/>
                </t>
                <t t-else="">
                    <t t-set="impuesto_rate" t-value="0.0"/>
                </t>
                <t t-set="total_rate" t-value="subtotal_rate + impuesto_rate"/>

            </t>

            <t t-call="import_customization.default_total_tagline_inc"/>
        </template>

        <template id="inc_usd_invoice">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.basic_layout">
                        <div class="head">
                            <div class="row">
                                <div class="col" style="width: 20%;">
                                    <img t-if="o.company_id.inc_logo" t-att-src="image_data_uri(o.company_id.inc_logo)" style="max-height: 65px;" alt="INC_Logo"/>
                                </div>
                                <div class="col" style="width: 80%;">
                                    <br/>
                                    <br/>
                                    <span>8550 NW 61 STREET, MIAMI, FLORIDA 33166</span>
                                </div>
                            </div>
                        </div>
                        <br/>
                        <div class="page" style="font-size: 10pt; font-family: Arial, Helvetica, sans-serif;">
                            <div class="oe_structure"/>
                            <t t-if="o.company_id.currency_id.name == 'USD'">
                                <t t-set="currency_obj" t-value="o.company_id.currency_id"/>
                            </t>
                            <t t-else="">
                                <t t-set="currency_obj" t-value="request.env['res.currency'].search([('name', '=', 'USD')])"/>
                            </t>

                             <t t-call="import_customization.upper_section"/>
                             <t t-call="import_customization.middle_section_usd"/>
                             <t t-call="import_customization.lower_inc_section_usd"/>
                        </div>

                        <div class="footer">
                            <!--  code -->
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>